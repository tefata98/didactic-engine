import{e as v,u as K,N as $,r as d,j as e,Z as Q,X,L as W,C as u,i as G,B as R}from"./index-CIBNcAki.js";import{G as N}from"./GlassCard-Bzn9mwsV.js";import{P as ee}from"./PageHeader-B7SkounL.js";import{B as F}from"./Badge-CkFNovJh.js";import{E as se}from"./EmptyState-Un6x2lRz.js";import{u as O,l as L}from"./dateHelpers-BBA6_RI6.js";import{R as te}from"./refresh-cw-iu8ozB0a.js";import{C as y}from"./clock-Cn21EuFH.js";import{S as ae}from"./search-CkDQf9Zc.js";import{T as ie}from"./trending-up-C0CEkwN_.js";import{C as ne}from"./chevron-left-CrwTPR9v.js";const re=v("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),g=v("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]]),E=v("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]),le=v("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]),ce="https://api.anthropic.com/v1/messages";async function oe(t,x=[]){var i;const o=x.length>0?x.join(", "):"Sleep, Fitness, Finance, Music, Vocals, Recruitment, Tech",n=await fetch(ce,{method:"POST",headers:{"Content-Type":"application/json","x-api-key":t,"anthropic-version":"2023-06-01","anthropic-dangerous-direct-browser-access":"true"},body:JSON.stringify({model:"claude-sonnet-4-20250514",max_tokens:8192,system:"You are a personalized news curator. Generate 10 realistic news articles as a JSON array. Each article must have: id (unique string), title, summary (2-3 sentences), content (full article body, 4-6 paragraphs of informative text), category (one of: Sleep, Fitness, Finance, Music, Vocals, Recruitment, Tech), tags (array of 2-3 relevant tags), source (realistic publication name), readingTime (estimated minutes as integer), and publishedAt (ISO 8601 date string within the last 24 hours). Return ONLY valid JSON with no markdown formatting, no code fences, and no extra text.",messages:[{role:"user",content:`Generate 10 news articles matching these interest categories: ${o}.

Return ONLY a valid JSON array with this structure:
[
  {
    "id": "unique-id",
    "title": "Article title",
    "summary": "2-3 sentence summary with practical, useful information",
    "content": "Full article body with 4-6 paragraphs. Include practical advice, research findings, expert quotes, and actionable takeaways. Separate paragraphs with \\n\\n.",
    "category": "One of: Sleep, Fitness, Finance, Music, Vocals, Recruitment, Tech",
    "tags": ["tag1", "tag2", "tag3"],
    "source": "Realistic source name",
    "readingTime": 3,
    "publishedAt": "ISO 8601 date string within the last 24 hours",
    "featured": false
  }
]

Make exactly 2-3 articles "featured": true. Make the content factually accurate and practically useful. Each article's content should be 4-6 substantive paragraphs.`}]})});if(!n.ok){const h=await n.json().catch(()=>({}));throw new Error(((i=h.error)==null?void 0:i.message)||`API error: ${n.status}`)}const c=(await n.json()).content[0].text;return JSON.parse(c).map((h,p)=>({...h,id:h.id||`art-${Date.now()}-${p}`,publishedAt:h.publishedAt||new Date(Date.now()-p*36e5).toISOString(),url:"#"}))}const M={All:u.primary,Sleep:u.sleep,Fitness:u.fitness,Finance:u.finance,Music:"#f97316",Vocals:u.vocals,Recruitment:u.work,Tech:"#38bdf8"},V=["All","Sleep","Fitness","Finance","Music","Vocals","Recruitment","Tech"],de=60*60*1e3;function J({article:t,isBookmarked:x,onToggleBookmark:o,onShare:n,onSelect:m,featured:c=!1}){const r=M[t.category]||u.primary;return c?e.jsxs(N,{padding:"p-0",className:"overflow-hidden",children:[e.jsx("div",{className:"h-1.5",style:{background:`linear-gradient(90deg, ${r}, ${r}99)`}}),e.jsxs("div",{className:"p-5 cursor-pointer",onClick:()=>m(t),children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(F,{color:r,children:t.category}),e.jsx("span",{className:"text-xs text-white/30",children:"Featured"}),t.readingTime&&e.jsxs("span",{className:"text-xs text-white/30 flex items-center gap-1 ml-auto",children:[e.jsx(R,{size:10}),t.readingTime," min read"]})]}),e.jsx("h3",{className:"font-heading font-bold text-white text-lg mb-2 leading-tight",children:t.title}),e.jsx("p",{className:"text-sm text-white/60 leading-relaxed mb-4",children:t.summary}),e.jsx("div",{className:"flex flex-wrap gap-1.5 mb-4",children:t.tags.map(i=>e.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs",style:{background:`${r}15`,color:`${r}cc`},children:i},i))}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-white/40",children:t.source}),e.jsx("span",{className:"text-xs text-white/20",children:"|"}),e.jsxs("span",{className:"text-xs text-white/40 flex items-center gap-1",children:[e.jsx(y,{size:10}),L(t.publishedAt)]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:i=>{i.stopPropagation(),o(t.id)},className:"p-2 rounded-lg hover:bg-white/10 transition-colors",children:x?e.jsx(g,{size:18,style:{color:r},className:"fill-current"}):e.jsx(g,{size:18,className:"text-white/40"})}),e.jsx("button",{onClick:i=>{i.stopPropagation(),n(t)},className:"p-2 rounded-lg hover:bg-white/10 transition-colors",children:e.jsx(E,{size:18,className:"text-white/40"})})]})]})]})]}):e.jsx(N,{padding:"p-0",className:"overflow-hidden",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-1 flex-shrink-0",style:{background:r}}),e.jsx("div",{className:"flex-1 p-4 cursor-pointer",onClick:()=>m(t),children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1.5",children:[e.jsx(F,{color:r,children:t.category}),t.readingTime&&e.jsxs("span",{className:"text-[10px] text-white/30 flex items-center gap-0.5",children:[e.jsx(R,{size:9}),t.readingTime,"m"]})]}),e.jsx("h4",{className:"font-medium text-white text-sm leading-tight mb-1.5",children:t.title}),e.jsx("p",{className:"text-xs text-white/50 leading-relaxed line-clamp-2 mb-2",children:t.summary}),e.jsx("div",{className:"flex flex-wrap gap-1 mb-2",children:t.tags.slice(0,3).map(i=>e.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px]",style:{background:`${r}10`,color:`${r}aa`},children:i},i))}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-white/30",children:t.source}),e.jsx("span",{className:"text-xs text-white/15",children:"|"}),e.jsxs("span",{className:"text-xs text-white/30 flex items-center gap-1",children:[e.jsx(y,{size:9}),L(t.publishedAt)]})]})]}),e.jsxs("div",{className:"flex flex-col items-center gap-0.5 flex-shrink-0",children:[e.jsx("button",{onClick:i=>{i.stopPropagation(),o(t.id)},className:"p-1.5 rounded-lg hover:bg-white/10 transition-colors",children:x?e.jsx(g,{size:16,style:{color:r},className:"fill-current"}):e.jsx(g,{size:16,className:"text-white/30"})}),e.jsx("button",{onClick:i=>{i.stopPropagation(),n(t)},className:"p-1.5 rounded-lg hover:bg-white/10 transition-colors",children:e.jsx(E,{size:16,className:"text-white/30"})})]})]})})]})})}function xe({article:t,isBookmarked:x,onToggleBookmark:o,onShare:n,onClose:m}){var r;const c=M[t.category]||u.primary;return e.jsx("div",{className:"fixed inset-0 z-50 bg-[#0f172a] overflow-y-auto",onClick:m,children:e.jsxs("div",{className:"min-h-full",onClick:i=>i.stopPropagation(),children:[e.jsx("div",{className:"sticky top-0 z-10 bg-[#0f172a]/95 backdrop-blur-lg border-b border-white/5",children:e.jsxs("div",{className:"flex items-center justify-between px-5 py-3 max-w-2xl mx-auto",children:[e.jsxs("button",{onClick:m,className:"flex items-center gap-2 text-white/60 hover:text-white transition-colors",children:[e.jsx(ne,{size:20}),e.jsx("span",{className:"text-sm font-medium",children:"Back"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>o(t.id),className:"p-2 rounded-lg hover:bg-white/10 transition-colors",children:x?e.jsx(g,{size:18,style:{color:c},className:"fill-current"}):e.jsx(g,{size:18,className:"text-white/40"})}),e.jsx("button",{onClick:()=>n(t),className:"p-2 rounded-lg hover:bg-white/10 transition-colors",children:e.jsx(E,{size:18,className:"text-white/40"})})]})]})}),e.jsxs("div",{className:"max-w-2xl mx-auto px-5 pt-6 pb-16",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(F,{color:c,children:t.category}),t.readingTime&&e.jsxs("span",{className:"text-xs text-white/40 flex items-center gap-1",children:[e.jsx(R,{size:12}),t.readingTime," min read"]})]}),e.jsx("h1",{className:"text-2xl font-heading font-bold text-white mb-4 leading-tight",children:t.title}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-white/40 mb-6 pb-6 border-b border-white/5",children:[e.jsx("span",{className:"font-medium text-white/60",children:t.source}),e.jsx("span",{className:"text-white/20",children:"|"}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(y,{size:12}),L(t.publishedAt)]})]}),e.jsx("div",{className:"rounded-xl p-4 mb-6",style:{background:`${c}10`,borderLeft:`3px solid ${c}`},children:e.jsx("p",{className:"text-sm text-white/70 leading-relaxed italic",children:t.summary})}),t.content?e.jsx("div",{className:"prose prose-invert max-w-none",children:t.content.split(`

`).map((i,h)=>e.jsx("p",{className:"text-[15px] text-white/70 leading-relaxed mb-4",children:i},h))}):e.jsx("p",{className:"text-sm text-white/50 italic",children:"Full article content not available. This article was generated before full content support was added. Refresh your news feed to get full articles."}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-8 pt-6 border-t border-white/5",children:[e.jsx(le,{size:14,className:"text-white/30"}),(r=t.tags)==null?void 0:r.map(i=>e.jsx("span",{className:"px-3 py-1 rounded-full text-xs",style:{background:`${c}15`,color:`${c}cc`},children:i},i))]})]})]})})}function ve(){const{state:t}=K(),{settings:x}=t,o=x.anthropicApiKey,[n,m]=O($.news,"articles",[]),[c,r]=O($.news,"lastFetch",0),[i,h]=O($.news,"bookmarks",[]),[p,P]=d.useState("All"),[f,B]=d.useState(""),[k,C]=d.useState(null),[b,I]=d.useState(!1),[D,A]=d.useState(null),U=d.useCallback(async()=>{if(o){I(!0),A(null);try{const s=await oe(o);m(s),r(Date.now())}catch(s){A(s.message||"Failed to fetch articles")}finally{I(!1)}}},[o,m,r]);d.useEffect(()=>{o&&(n.length===0||Date.now()-c>de)&&U()},[]);const j=d.useMemo(()=>{let s=n;if(p!=="All"&&(s=s.filter(a=>a.category===p)),f.trim()){const a=f.toLowerCase();s=s.filter(l=>{var w;return l.title.toLowerCase().includes(a)||l.summary.toLowerCase().includes(a)||((w=l.tags)==null?void 0:w.some(Z=>Z.toLowerCase().includes(a)))})}return s},[n,p,f]),q=d.useMemo(()=>j.filter(s=>s.featured),[j]),S=d.useMemo(()=>j.filter(s=>!s.featured),[j]);function z(s){h(a=>a.includes(s)?a.filter(l=>l!==s):[...a,s])}function T(s){navigator.share?navigator.share({title:s.title,text:s.summary,url:s.url||window.location.href}).catch(()=>{}):navigator.clipboard.writeText(`${s.title}
${s.summary}`).then(()=>{const a=document.createElement("div");a.textContent="Copied to clipboard!",a.className="fixed bottom-24 left-1/2 -translate-x-1/2 glass-card-sm px-4 py-2 text-sm text-white z-50",document.body.appendChild(a),setTimeout(()=>a.remove(),2e3)}).catch(()=>{})}const _=i.length,H=d.useMemo(()=>{const s={};return V.forEach(a=>{a==="All"?s[a]=n.length:s[a]=n.filter(l=>l.category===a).length}),s},[n]),Y=d.useMemo(()=>{if(!c)return null;const s=Date.now()-c,a=Math.floor(s/6e4);if(a<1)return"Updated just now";if(a<60)return`Updated ${a}m ago`;const l=Math.floor(a/60);return l<24?`Updated ${l}h ago`:`Updated ${Math.floor(l/24)}d ago`},[c]);return k?e.jsx(xe,{article:k,isBookmarked:i.includes(k.id),onToggleBookmark:z,onShare:T,onClose:()=>C(null)}):e.jsxs("div",{className:"space-y-4 pb-4",children:[e.jsx(ee,{title:"News Feed",subtitle:"Curated articles for your interests",rightElement:e.jsx("div",{className:"flex items-center gap-3",children:o&&e.jsxs("button",{onClick:U,disabled:b,className:"flex items-center gap-2 px-3 py-1.5 rounded-xl bg-indigo-500/15 hover:bg-indigo-500/25 border border-indigo-500/20 transition-all disabled:opacity-50",children:[e.jsx(te,{size:14,className:`text-indigo-400 ${b?"animate-spin":""}`}),e.jsx("span",{className:"text-xs font-medium text-indigo-400",children:"Refresh"})]})})}),n.length>0&&e.jsxs("div",{className:"flex items-center justify-between text-xs text-white/30 px-1",children:[e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx(y,{size:11}),Y]}),e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx(g,{size:11}),_," saved"]})]}),!o&&e.jsxs(N,{className:"text-center py-8",children:[e.jsx(Q,{size:32,className:"text-indigo-400 mx-auto mb-3"}),e.jsx("h3",{className:"text-white font-heading font-semibold mb-2",children:"AI-Powered News"}),e.jsx("p",{className:"text-sm text-white/50 max-w-sm mx-auto",children:"Add your Anthropic API key in Settings â†’ Integrations to get personalized AI-curated news"})]}),D&&e.jsx(N,{className:"border border-red-500/20",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(re,{size:18,className:"text-red-400 flex-shrink-0"}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("p",{className:"text-sm text-red-400",children:D})}),e.jsx("button",{onClick:()=>A(null),className:"text-white/40 hover:text-white/60",children:e.jsx(X,{size:16})})]})}),b&&e.jsxs(N,{className:"text-center py-8",children:[e.jsx(W,{size:24,className:"text-indigo-400 mx-auto mb-3 animate-spin"}),e.jsx("p",{className:"text-sm text-white/50",children:"Generating personalized articles..."})]}),n.length>0&&e.jsxs("div",{className:"sticky top-0 z-30 -mx-5 px-5 pt-2 pb-3 bg-[#0f172a]/95 backdrop-blur-lg",children:[e.jsxs("div",{className:"relative mb-3",children:[e.jsx(ae,{size:16,className:"absolute left-4 top-1/2 -translate-y-1/2 text-white/30"}),e.jsx("input",{type:"text",value:f,onChange:s=>B(s.target.value),placeholder:"Search articles...",className:"glass-input text-sm pl-10"})]}),e.jsx("div",{className:"flex gap-2 overflow-x-auto no-scrollbar",children:V.map(s=>{const a=M[s],l=p===s,w=H[s];return e.jsxs("button",{onClick:()=>P(s),className:`flex items-center gap-1.5 px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-all flex-shrink-0 ${l?"text-white shadow-lg":"text-white/50 hover:text-white/70"}`,style:{background:l?`${a}30`:"rgba(255,255,255,0.04)",border:`1px solid ${l?`${a}50`:"rgba(255,255,255,0.06)"}`,color:l?a:void 0,boxShadow:l?`0 2px 12px ${a}20`:"none"},children:[s,w>0&&e.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded-full font-bold",style:{background:l?`${a}30`:"rgba(255,255,255,0.08)"},children:w})]},s)})})]}),q.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"font-heading font-semibold text-white mb-3 flex items-center gap-2",children:[e.jsx(ie,{size:16,className:"text-indigo-400"}),"Featured"]}),e.jsx("div",{className:"space-y-3",children:q.map(s=>e.jsx(J,{article:s,isBookmarked:i.includes(s.id),onToggleBookmark:z,onShare:T,onSelect:C,featured:!0},s.id))})]}),S.length>0?e.jsxs("div",{children:[e.jsxs("h3",{className:"font-heading font-semibold text-white mb-3 flex items-center gap-2",children:[e.jsx(G,{size:16,className:"text-white/40"}),"Latest Articles",e.jsxs("span",{className:"text-xs text-white/30 font-normal",children:["(",S.length,")"]})]}),e.jsx("div",{className:"space-y-3",children:S.map(s=>e.jsx(J,{article:s,isBookmarked:i.includes(s.id),onToggleBookmark:z,onShare:T,onSelect:C},s.id))})]}):!b&&n.length>0&&j.length===0&&e.jsx(se,{icon:G,title:"No articles found",description:f?`No articles match "${f}"`:`No articles in ${p} category`,action:{label:"View All",onClick:()=>{P("All"),B("")}}})]})}export{ve as default};

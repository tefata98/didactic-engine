import{u as C,r as s,j as e,L as E}from"./index-BeXUHYuJ.js";import{a as U,S as k}from"./syncService-BEbOdjZx.js";import{A as L}from"./alert-circle-CAgHdMEb.js";import{W as T}from"./wifi-B4qLB2L4.js";function D(){const{state:f,dispatch:a}=C(),{settings:c}=f,[r,w]=s.useState(""),[d,j]=s.useState(""),[i,y]=s.useState(c.supabaseUrl||""),[l,v]=s.useState(c.supabaseAnonKey||""),[x,m]=s.useState(!1),[p,n]=s.useState(null),[u,h]=s.useState(!c.supabaseUrl),N=async t=>{if(t.preventDefault(),!r.trim()||!d.trim()){n("Please enter username and password");return}if(!i.trim()||!l.trim()){n("Please configure Supabase first"),h(!0);return}m(!0),n(null);try{a({type:"UPDATE_SETTINGS",payload:{supabaseUrl:i.trim(),supabaseAnonKey:l.trim()}});const o=U(i.trim(),l.trim());if(!o)throw new Error("Failed to initialize Supabase");const S=`${r.trim()}@light.app`,{data:b,error:g}=await o.auth.signInWithPassword({email:S,password:d.trim()});if(g)throw g;a({type:"SET_AUTH",payload:{isAuthenticated:!0,userId:b.user.id,email:b.user.email,username:r.trim()}});try{await k.pullAll(),a({type:"HYDRATE"})}catch(A){console.warn("Initial sync failed:",A.message)}}catch(o){n(o.message||"Login failed")}finally{m(!1)}};return e.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center px-6 relative",children:[e.jsx("div",{className:"floating-orb",style:{width:300,height:300,background:"radial-gradient(circle, rgba(99,102,241,0.15), transparent 70%)",top:"5%",left:"-10%"}}),e.jsx("div",{className:"floating-orb",style:{width:250,height:250,background:"radial-gradient(circle, rgba(139,92,246,0.12), transparent 70%)",bottom:"10%",right:"-5%",animationDelay:"2s"}}),e.jsx("div",{className:"w-20 h-20 rounded-3xl bg-gradient-to-br from-indigo-500 to-violet-600 flex items-center justify-center mb-6 shadow-2xl",children:e.jsx("span",{className:"text-3xl font-heading font-bold text-white",children:"L"})}),e.jsx("h1",{className:"text-3xl font-heading font-bold text-white mb-1",children:"Light"}),e.jsx("p",{className:"text-sm text-white/50 mb-8",children:"Your personal life dashboard"}),e.jsxs("div",{className:"glass-card w-full max-w-sm p-6",children:[p&&e.jsxs("div",{className:"flex items-center gap-2 p-3 rounded-xl bg-red-500/10 border border-red-500/20 mb-4",children:[e.jsx(L,{size:16,className:"text-red-400 flex-shrink-0"}),e.jsx("p",{className:"text-xs text-red-400",children:p})]}),e.jsxs("form",{onSubmit:N,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-white/40 mb-1.5 block",children:"Username"}),e.jsx("input",{type:"text",value:r,onChange:t=>w(t.target.value),placeholder:"tefata",className:"glass-input",autoFocus:!0,autoComplete:"username"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-white/40 mb-1.5 block",children:"Password"}),e.jsx("input",{type:"password",value:d,onChange:t=>j(t.target.value),placeholder:"Enter password",className:"glass-input",autoComplete:"current-password"})]}),e.jsx("button",{type:"submit",disabled:x,className:"w-full py-3.5 rounded-xl font-heading font-semibold text-white flex items-center justify-center gap-2 transition-all active:scale-95 disabled:opacity-50",style:{background:"linear-gradient(135deg, #6366f1, #8b5cf6)",boxShadow:"0 4px 20px rgba(99,102,241,0.3)"},children:x?e.jsxs(e.Fragment,{children:[e.jsx(E,{size:18,className:"animate-spin"})," Signing in..."]}):"Sign In"})]}),e.jsxs("div",{className:"mt-5 pt-5 border-t border-white/5",children:[e.jsxs("button",{onClick:()=>h(!u),className:"text-xs text-white/30 hover:text-white/50 transition-colors flex items-center gap-1.5",children:[e.jsx(T,{size:12}),u?"Hide":"Configure"," Supabase"]}),u&&e.jsxs("div",{className:"mt-3 space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] text-white/30 mb-1 block",children:"Supabase URL"}),e.jsx("input",{type:"url",value:i,onChange:t=>y(t.target.value),placeholder:"https://xxx.supabase.co",className:"glass-input text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] text-white/30 mb-1 block",children:"Anon Key"}),e.jsx("input",{type:"password",value:l,onChange:t=>v(t.target.value),placeholder:"eyJhbGciOiJ...",className:"glass-input text-xs"})]})]})]})]}),e.jsx("button",{onClick:()=>a({type:"SET_AUTH",payload:{isAuthenticated:!0,userId:null,email:null,username:"guest"}}),className:"mt-6 text-xs text-white/30 hover:text-white/50 transition-colors",children:"Continue without login"}),e.jsx("p",{className:"text-[10px] text-white/20 mt-8",children:"Light v3.0.0"})]})}export{D as default};

import{e as k,j as e,u as S,r as m,M,F as L,b as W,d as G,c as U,B as V,S as v}from"./index-DPMPy1jo.js";import{G as q}from"./GlassCard-BGTSY6va.js";import{P as F}from"./PageHeader-BGuk2ej9.js";import{B as _}from"./bell-B54_qaEb.js";import{S as B}from"./sun-BalYKXp1.js";import{V as $}from"./volume-2-Ct26BAjs.js";import{R as z}from"./refresh-cw-C0PwWbxb.js";import{T as H}from"./trash-2-9RAovqSw.js";const T=k("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),J=k("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),A=k("WifiOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 4.17-2.65",key:"11utq1"}],["path",{d:"M10.66 5c4.01-.36 8.14.9 11.34 3.76",key:"hxefdu"}],["path",{d:"M16.85 11.25a10 10 0 0 1 2.22 1.68",key:"q734kn"}],["path",{d:"M5 13a10 10 0 0 1 5.24-2.76",key:"piq4yl"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]),Y=k("Wifi",[["path",{d:"M5 13a10 10 0 0 1 14 0",key:"6v8j51"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]);function x({enabled:c,onChange:i}){return e.jsx("button",{onClick:()=>i==null?void 0:i(!c),className:`relative w-12 h-7 rounded-full transition-all duration-300 flex-shrink-0 ${c?"bg-gradient-to-r from-indigo-500 to-violet-500":"bg-white/10"}`,children:e.jsx("div",{className:`absolute top-0.5 w-6 h-6 rounded-full bg-white shadow-lg transition-transform duration-300 ${c?"translate-x-[22px]":"translate-x-0.5"}`})})}function K(){const{state:c}=S(),i=m.useRef(null),n=m.useCallback(()=>((!i.current||i.current.state==="closed")&&(i.current=new(window.AudioContext||window.webkitAudioContext)),i.current.state==="suspended"&&i.current.resume(),i.current),[]),a=m.useCallback((o,d,p="sine",r=.15)=>{if(c.settings.soundEffects)try{const s=n(),l=s.createOscillator(),g=s.createGain();l.type=p,l.frequency.setValueAtTime(o,s.currentTime),g.gain.setValueAtTime(r,s.currentTime),g.gain.exponentialRampToValueAtTime(.001,s.currentTime+d),l.connect(g),g.connect(s.destination),l.start(s.currentTime),l.stop(s.currentTime+d)}catch{}},[c.settings.soundEffects,n]),E=m.useCallback(()=>{a(800,.08,"sine",.08)},[a]),y=m.useCallback(()=>{if(c.settings.soundEffects)try{const o=n(),d=o.currentTime;[523.25,659.25].forEach((p,r)=>{const s=o.createOscillator(),l=o.createGain();s.type="sine",s.frequency.setValueAtTime(p,d),l.gain.setValueAtTime(.12,d+r*.12),l.gain.exponentialRampToValueAtTime(.001,d+r*.12+.3),s.connect(l),l.connect(o.destination),s.start(d+r*.12),s.stop(d+r*.12+.3)})}catch{}},[c.settings.soundEffects,n]),N=m.useCallback(o=>{a(o?660:440,.1,"sine",.1)},[a]),w=m.useCallback(()=>{if(c.settings.soundEffects)try{const o=n(),d=o.currentTime;[587.33,698.46,880].forEach((p,r)=>{const s=o.createOscillator(),l=o.createGain();s.type="triangle",s.frequency.setValueAtTime(p,d),l.gain.setValueAtTime(.15,d+r*.15),l.gain.exponentialRampToValueAtTime(.001,d+r*.15+.4),s.connect(l),l.connect(o.destination),s.start(d+r*.15),s.stop(d+r*.15+.4)})}catch{}},[c.settings.soundEffects,n]);return{tap:E,success:y,toggle:N,timerDone:w}}function u({icon:c,label:i,description:n,children:a}){return e.jsxs("div",{className:"flex items-center justify-between py-3",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsx("div",{className:"w-9 h-9 rounded-xl bg-white/5 flex items-center justify-center flex-shrink-0",children:e.jsx(c,{size:18,className:"text-white/60"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-white",children:i}),n&&e.jsx("p",{className:"text-xs text-white/40 mt-0.5",children:n})]})]}),e.jsx("div",{className:"flex-shrink-0 ml-3",children:a})]})}function j({title:c,children:i}){return e.jsxs(q,{className:"mb-4",children:[e.jsx("h3",{className:"text-xs font-semibold text-white/40 uppercase tracking-wider mb-2",children:c}),e.jsx("div",{className:"divide-y divide-white/5",children:i})]})}function ae(){const{state:c,dispatch:i}=S(),{settings:n}=c,a=K(),[E,y]=m.useState(!1),[N,w]=m.useState(navigator.onLine),[o,d]=m.useState(typeof Notification<"u"?Notification.permission:"denied");m.useEffect(()=>{const t=()=>w(!0),f=()=>w(!1);return window.addEventListener("online",t),window.addEventListener("offline",f),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",f)}},[]);const p=async()=>{if(typeof Notification>"u")return;const t=await Notification.requestPermission();d(t)},r=(t,f)=>{i({type:"UPDATE_SETTINGS",payload:{[t]:f}})},s=t=>{r("darkMode",t),a.toggle(t),t?document.documentElement.removeAttribute("data-theme"):document.documentElement.setAttribute("data-theme","light")};m.useEffect(()=>{n.darkMode?document.documentElement.removeAttribute("data-theme"):document.documentElement.setAttribute("data-theme","light")},[n.darkMode]);const l=t=>{r("soundEffects",t),t&&setTimeout(()=>a.toggle(!0),50)},g=t=>{r("offlineMode",t),a.toggle(t),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(f=>{var h;(h=f.active)==null||h.postMessage({type:"SET_OFFLINE_MODE",payload:{enabled:t}})})},C=async t=>{if(t&&window.PublicKeyCredential)try{if(!await PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable()){alert("Biometric authentication is not available on this device.");return}}catch{}r("faceId",t),a.toggle(t),t||sessionStorage.removeItem("light_locked")},D=()=>{const t=v.exportAll(),f=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),h=URL.createObjectURL(f),b=document.createElement("a");b.href=h,b.download=`light-backup-${new Date().toISOString().split("T")[0]}.json`,b.click(),URL.revokeObjectURL(h),a.success()},R=()=>{const t=document.createElement("input");t.type="file",t.accept=".json",t.onchange=f=>{const h=f.target.files[0];if(!h)return;const b=new FileReader;b.onload=I=>{try{const O=JSON.parse(I.target.result);v.importAll(O),i({type:"HYDRATE"}),a.success()}catch{alert("Invalid backup file")}},b.readAsText(h)},t.click()},P=()=>{v.clearAll(),i({type:"HYDRATE"}),y(!1)};return e.jsxs("div",{className:"space-y-2 pb-4",children:[e.jsx(F,{title:"Settings",subtitle:"Customize your experience"}),!N&&e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 rounded-xl bg-amber-500/10 border border-amber-500/20 mb-2",children:[e.jsx(A,{size:16,className:"text-amber-400"}),e.jsx("span",{className:"text-sm text-amber-400",children:"You're offline â€” data is saved locally"})]}),e.jsxs(j,{title:"General",children:[e.jsx(u,{icon:_,label:"Push Notifications",description:o==="granted"?"Sent via Service Worker":o==="denied"?"Blocked in browser settings":"Get reminders and alerts",children:e.jsxs("div",{className:"flex items-center gap-2",children:[o==="default"&&n.notifications&&e.jsx("button",{onClick:p,className:"text-xs text-indigo-400",children:"Allow"}),e.jsx(x,{enabled:n.notifications,onChange:t=>{r("notifications",t),a.toggle(t),t&&o==="default"&&p()}})]})}),e.jsx(u,{icon:n.darkMode?M:B,label:"Dark Mode",description:n.darkMode?"Dark theme active":"Light theme active",children:e.jsx(x,{enabled:n.darkMode,onChange:s})}),e.jsx(u,{icon:$,label:"Sound Effects",description:"Tap, success, and timer sounds",children:e.jsx(x,{enabled:n.soundEffects,onChange:l})}),e.jsx(u,{icon:z,label:"Auto Sync",description:n.autoSync?"Syncs when data changes":"Manual sync only",children:e.jsx(x,{enabled:n.autoSync,onChange:t=>{r("autoSync",t),a.toggle(t)}})})]}),e.jsxs(j,{title:"Privacy & Security",children:[e.jsx(u,{icon:L,label:"Face ID / Fingerprint",description:"Lock app when switching away",children:e.jsx(x,{enabled:n.faceId,onChange:C})}),e.jsx(u,{icon:n.offlineMode?A:Y,label:"Offline Mode",description:n.offlineMode?"Cache-first, works offline":"Network-first, always fresh",children:e.jsx(x,{enabled:n.offlineMode,onChange:g})})]}),e.jsxs(j,{title:"Reminders",children:[e.jsx(u,{icon:M,label:"Sleep Wind-Down",description:`Daily at ${n.reminders.sleepWindDown.time||"10:30 PM"}`,children:e.jsx(x,{enabled:n.reminders.sleepWindDown.enabled,onChange:t=>{i({type:"UPDATE_REMINDER",payload:{sleepWindDown:{...n.reminders.sleepWindDown,enabled:t}}}),a.toggle(t)}})}),e.jsx(u,{icon:W,label:"Workout",description:`Mon/Wed/Fri at ${n.reminders.workout.time||"7:00 AM"}`,children:e.jsx(x,{enabled:n.reminders.workout.enabled,onChange:t=>{i({type:"UPDATE_REMINDER",payload:{workout:{...n.reminders.workout,enabled:t}}}),a.toggle(t)}})}),e.jsx(u,{icon:G,label:"Vocal Practice",description:`Daily at ${n.reminders.vocalPractice.time||"6:00 PM"}`,children:e.jsx(x,{enabled:n.reminders.vocalPractice.enabled,onChange:t=>{i({type:"UPDATE_REMINDER",payload:{vocalPractice:{...n.reminders.vocalPractice,enabled:t}}}),a.toggle(t)}})}),e.jsx(u,{icon:U,label:"Budget Alerts",description:"Spending notifications",children:e.jsx(x,{enabled:n.reminders.budgetAlerts.enabled,onChange:t=>{i({type:"UPDATE_REMINDER",payload:{budgetAlerts:{...n.reminders.budgetAlerts,enabled:t}}}),a.toggle(t)}})}),e.jsx(u,{icon:V,label:"Reading Goal",description:`Daily at ${n.reminders.readingGoal.time||"9:00 PM"}`,children:e.jsx(x,{enabled:n.reminders.readingGoal.enabled,onChange:t=>{i({type:"UPDATE_REMINDER",payload:{readingGoal:{...n.reminders.readingGoal,enabled:t}}}),a.toggle(t)}})})]}),e.jsxs("button",{className:"w-full py-4 rounded-glass font-heading font-semibold text-white flex items-center justify-center gap-2 mb-4",style:{background:"linear-gradient(135deg, #6366f1, #8b5cf6)",boxShadow:"0 4px 20px rgba(99,102,241,0.3)"},onClick:()=>{window.deferredPrompt&&window.deferredPrompt.prompt()},children:[e.jsx(T,{size:20}),"Install App"]}),e.jsxs(j,{title:"Data Management",children:[e.jsx(u,{icon:T,label:"Export Data",description:"Download JSON backup",children:e.jsx("button",{onClick:D,className:"btn-ghost text-xs",children:"Export"})}),e.jsx(u,{icon:J,label:"Import Data",description:"Restore from backup",children:e.jsx("button",{onClick:R,className:"btn-ghost text-xs",children:"Import"})}),e.jsx(u,{icon:H,label:"Clear All Data",description:"Delete everything",children:E?e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:P,className:"px-3 py-1.5 rounded-xl text-xs font-medium text-white bg-red-500 hover:bg-red-600 transition-colors",children:"Confirm"}),e.jsx("button",{onClick:()=>y(!1),className:"px-3 py-1.5 rounded-xl text-xs font-medium text-white/50 bg-white/5",children:"Cancel"})]}):e.jsx("button",{onClick:()=>y(!0),className:"px-3 py-1.5 rounded-xl text-xs font-medium text-red-400 bg-red-500/10 hover:bg-red-500/20 transition-colors",children:"Clear"})})]}),e.jsxs("div",{className:"text-center py-6",children:[e.jsx("p",{className:"text-xs text-white/30",children:"Light v3.0.0"}),e.jsx("p",{className:"text-xs text-white/20 mt-1",children:"Made with care for Stefan"})]})]})}export{ae as default};

import{e as v,u as Q,N as S,r as o,j as e,Z as X,X as q,C as x,i as D}from"./index-Ss6e5mUo.js";import{G as N}from"./GlassCard-BuBGN_tw.js";import{P as Z}from"./PageHeader-BtYUvTlI.js";import{B as $}from"./Badge-hEOuLxke.js";import{E as W}from"./EmptyState-_k1j1nOT.js";import{u as z,l as O}from"./dateHelpers-CmyOk_wD.js";import{R as ee}from"./refresh-cw-BYrf8t2h.js";import{S as se}from"./search-C3h2nT8g.js";import{T as te}from"./trending-up-DnQuJaCO.js";import{C as R}from"./clock-DJBSVi2d.js";const ae=v("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),w=v("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]]),ie=v("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),J=v("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]),le="https://api.anthropic.com/v1/messages";async function ne(t,h=[]){var i;const c=h.length>0?h.join(", "):"Sleep, Fitness, Finance, Music, Vocals, Recruitment, Tech",l=await fetch(le,{method:"POST",headers:{"Content-Type":"application/json","x-api-key":t,"anthropic-version":"2023-06-01","anthropic-dangerous-direct-browser-access":"true"},body:JSON.stringify({model:"claude-sonnet-4-20250514",max_tokens:4096,system:"You are a personalized news curator. Generate 10 realistic news articles as a JSON array. Each article must have: id (unique string), title, summary (2-3 sentences), category (one of: Sleep, Fitness, Finance, Music, Vocals, Recruitment, Tech), tags (array of 2-3 relevant tags), source (realistic publication name), and publishedAt (ISO 8601 date string within the last 24 hours). Return ONLY valid JSON with no markdown formatting, no code fences, and no extra text.",messages:[{role:"user",content:`Generate 10 news articles matching these interest categories: ${c}.

Return ONLY a valid JSON array with this structure:
[
  {
    "id": "unique-id",
    "title": "Article title",
    "summary": "2-3 sentence summary with practical, useful information",
    "category": "One of: Sleep, Fitness, Finance, Music, Vocals, Recruitment, Tech",
    "tags": ["tag1", "tag2", "tag3"],
    "source": "Realistic source name",
    "publishedAt": "ISO 8601 date string within the last 24 hours",
    "featured": false
  }
]

Make exactly 2-3 articles "featured": true. Make the content factually accurate and practically useful.`}]})});if(!l.ok){const u=await l.json().catch(()=>({}));throw new Error(((i=u.error)==null?void 0:i.message)||`API error: ${l.status}`)}const f=(await l.json()).content[0].text;return JSON.parse(f).map((u,m)=>({...u,id:u.id||`art-${Date.now()}-${m}`,publishedAt:u.publishedAt||new Date(Date.now()-m*36e5).toISOString(),url:"#"}))}const y={All:x.primary,Sleep:x.sleep,Fitness:x.fitness,Finance:x.finance,Music:"#f97316",Vocals:x.vocals,Recruitment:x.work,Tech:"#38bdf8"},_=["All","Sleep","Fitness","Finance","Music","Vocals","Recruitment","Tech"],re=6*60*60*1e3;function Y({article:t,isBookmarked:h,onToggleBookmark:c,onShare:l,onSelect:p,featured:f=!1}){const n=y[t.category]||x.primary;return f?e.jsxs(N,{padding:"p-0",className:"overflow-hidden",children:[e.jsx("div",{className:"h-1.5",style:{background:`linear-gradient(90deg, ${n}, ${n}99)`}}),e.jsxs("div",{className:"p-5 cursor-pointer",onClick:()=>p(t),children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx($,{color:n,children:t.category}),e.jsx("span",{className:"text-xs text-white/30",children:"Featured"})]}),e.jsx("h3",{className:"font-heading font-bold text-white text-lg mb-2 leading-tight",children:t.title}),e.jsx("p",{className:"text-sm text-white/60 leading-relaxed mb-4",children:t.summary}),e.jsx("div",{className:"flex flex-wrap gap-1.5 mb-4",children:t.tags.map(i=>e.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs",style:{background:`${n}15`,color:`${n}cc`},children:i},i))}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-white/40",children:t.source}),e.jsx("span",{className:"text-xs text-white/20",children:"|"}),e.jsxs("span",{className:"text-xs text-white/40 flex items-center gap-1",children:[e.jsx(R,{size:10}),O(t.publishedAt)]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:i=>{i.stopPropagation(),c(t.id)},className:"p-2 rounded-lg hover:bg-white/10 transition-colors",children:h?e.jsx(w,{size:18,style:{color:n},className:"fill-current"}):e.jsx(w,{size:18,className:"text-white/40"})}),e.jsx("button",{onClick:i=>{i.stopPropagation(),l(t)},className:"p-2 rounded-lg hover:bg-white/10 transition-colors",children:e.jsx(J,{size:18,className:"text-white/40"})})]})]})]})]}):e.jsx(N,{padding:"p-0",className:"overflow-hidden",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-1 flex-shrink-0",style:{background:n}}),e.jsx("div",{className:"flex-1 p-4 cursor-pointer",onClick:()=>p(t),children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"flex items-center gap-2 mb-1.5",children:e.jsx($,{color:n,children:t.category})}),e.jsx("h4",{className:"font-medium text-white text-sm leading-tight mb-1.5",children:t.title}),e.jsx("p",{className:"text-xs text-white/50 leading-relaxed line-clamp-2 mb-2",children:t.summary}),e.jsx("div",{className:"flex flex-wrap gap-1 mb-2",children:t.tags.slice(0,3).map(i=>e.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px]",style:{background:`${n}10`,color:`${n}aa`},children:i},i))}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-white/30",children:t.source}),e.jsx("span",{className:"text-xs text-white/15",children:"|"}),e.jsxs("span",{className:"text-xs text-white/30 flex items-center gap-1",children:[e.jsx(R,{size:9}),O(t.publishedAt)]})]})]}),e.jsxs("div",{className:"flex flex-col items-center gap-0.5 flex-shrink-0",children:[e.jsx("button",{onClick:i=>{i.stopPropagation(),c(t.id)},className:"p-1.5 rounded-lg hover:bg-white/10 transition-colors",children:h?e.jsx(w,{size:16,style:{color:n},className:"fill-current"}):e.jsx(w,{size:16,className:"text-white/30"})}),e.jsx("button",{onClick:i=>{i.stopPropagation(),l(t)},className:"p-1.5 rounded-lg hover:bg-white/10 transition-colors",children:e.jsx(J,{size:16,className:"text-white/30"})})]})]})})]})})}function je(){var G;const{state:t}=Q(),{settings:h}=t,c=h.anthropicApiKey,[l,p]=z(S.news,"articles",[]),[f,n]=z(S.news,"lastFetch",0),[i,u]=z(S.news,"bookmarks",[]),[m,F]=o.useState("All"),[g,E]=o.useState(""),[d,b]=o.useState(null),[k,L]=o.useState(!1),[T,A]=o.useState(null),P=o.useCallback(async()=>{if(c){L(!0),A(null);try{const s=await ne(c);p(s),n(Date.now())}catch(s){A(s.message||"Failed to fetch articles")}finally{L(!1)}}},[c,p,n]);o.useEffect(()=>{c&&(l.length===0||Date.now()-f>re)&&P()},[]);const j=o.useMemo(()=>{let s=l;if(m!=="All"&&(s=s.filter(a=>a.category===m)),g.trim()){const a=g.toLowerCase();s=s.filter(r=>{var V;return r.title.toLowerCase().includes(a)||r.summary.toLowerCase().includes(a)||((V=r.tags)==null?void 0:V.some(K=>K.toLowerCase().includes(a)))})}return s},[l,m,g]),M=o.useMemo(()=>j.filter(s=>s.featured),[j]),C=o.useMemo(()=>j.filter(s=>!s.featured),[j]);function I(s){u(a=>a.includes(s)?a.filter(r=>r!==s):[...a,s])}function B(s){navigator.share?navigator.share({title:s.title,text:s.summary,url:s.url||window.location.href}).catch(()=>{}):navigator.clipboard.writeText(`${s.title}
${s.summary}`).then(()=>{const a=document.createElement("div");a.textContent="Copied to clipboard!",a.className="fixed bottom-24 left-1/2 -translate-x-1/2 glass-card-sm px-4 py-2 text-sm text-white z-50",document.body.appendChild(a),setTimeout(()=>a.remove(),2e3)}).catch(()=>{})}const H=i.length,U=o.useMemo(()=>{const s={};return _.forEach(a=>{a==="All"?s[a]=l.length:s[a]=l.filter(r=>r.category===a).length}),s},[l]);return e.jsxs("div",{className:"space-y-6 pb-4",children:[e.jsx(Z,{title:"News Feed",subtitle:"Curated articles for your interests",rightElement:e.jsxs("div",{className:"flex items-center gap-3",children:[c&&e.jsx("button",{onClick:P,disabled:k,className:"p-2 rounded-xl bg-white/5 hover:bg-white/10 transition-colors disabled:opacity-50",children:e.jsx(ee,{size:16,className:`text-white/60 ${k?"animate-spin":""}`})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(w,{size:16,className:"text-white/40"}),e.jsxs("span",{className:"text-sm text-white/40",children:[H," saved"]})]})]})}),!c&&e.jsxs(N,{className:"text-center py-8",children:[e.jsx(X,{size:32,className:"text-indigo-400 mx-auto mb-3"}),e.jsx("h3",{className:"text-white font-heading font-semibold mb-2",children:"AI-Powered News"}),e.jsx("p",{className:"text-sm text-white/50 max-w-sm mx-auto",children:"Add your Anthropic API key in Settings â†’ Integrations to get personalized AI-curated news"})]}),T&&e.jsx(N,{className:"border border-red-500/20",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ae,{size:18,className:"text-red-400 flex-shrink-0"}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("p",{className:"text-sm text-red-400",children:T})}),e.jsx("button",{onClick:()=>A(null),className:"text-white/40 hover:text-white/60",children:e.jsx(q,{size:16})})]})}),k&&e.jsxs(N,{className:"text-center py-8",children:[e.jsx(ie,{size:24,className:"text-indigo-400 mx-auto mb-3 animate-spin"}),e.jsx("p",{className:"text-sm text-white/50",children:"Generating personalized articles..."})]}),l.length>0&&e.jsxs("div",{className:"relative",children:[e.jsx(se,{size:16,className:"absolute left-4 top-1/2 -translate-y-1/2 text-white/30"}),e.jsx("input",{type:"text",value:g,onChange:s=>E(s.target.value),placeholder:"Search articles...",className:"glass-input text-sm pl-10"})]}),l.length>0&&e.jsx("div",{className:"flex gap-2 overflow-x-auto no-scrollbar pb-1",children:_.map(s=>{const a=y[s],r=m===s;return e.jsxs("button",{onClick:()=>F(s),className:`flex items-center gap-1.5 px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-all flex-shrink-0 ${r?"text-white":"text-white/50 hover:text-white/70"}`,style:{background:r?`${a}25`:"rgba(255,255,255,0.04)",border:`1px solid ${r?`${a}40`:"rgba(255,255,255,0.06)"}`,color:r?a:void 0},children:[s,e.jsx("span",{className:"text-xs opacity-60",children:U[s]})]},s)})}),M.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"font-heading font-semibold text-white mb-3 flex items-center gap-2",children:[e.jsx(te,{size:16,className:"text-indigo-400"}),"Featured"]}),e.jsx("div",{className:"space-y-3",children:M.map(s=>e.jsx(Y,{article:s,isBookmarked:i.includes(s.id),onToggleBookmark:I,onShare:B,onSelect:b,featured:!0},s.id))})]}),C.length>0?e.jsxs("div",{children:[e.jsxs("h3",{className:"font-heading font-semibold text-white mb-3 flex items-center gap-2",children:[e.jsx(D,{size:16,className:"text-white/40"}),"Latest Articles",e.jsxs("span",{className:"text-xs text-white/30 font-normal",children:["(",C.length,")"]})]}),e.jsx("div",{className:"space-y-3",children:C.map(s=>e.jsx(Y,{article:s,isBookmarked:i.includes(s.id),onToggleBookmark:I,onShare:B,onSelect:b},s.id))})]}):!k&&l.length>0&&j.length===0&&e.jsx(W,{icon:D,title:"No articles found",description:g?`No articles match "${g}"`:`No articles in ${m} category`,action:{label:"View All",onClick:()=>{F("All"),E("")}}}),d&&e.jsx("div",{className:"fixed inset-0 z-50 bg-black/90 backdrop-blur-md overflow-y-auto",onClick:()=>b(null),children:e.jsxs("div",{className:"min-h-full flex flex-col",onClick:s=>s.stopPropagation(),children:[e.jsx("div",{className:"flex justify-end p-4 sticky top-0 z-10",children:e.jsx("button",{onClick:()=>b(null),className:"w-10 h-10 rounded-full bg-white/10 hover:bg-white/20 flex items-center justify-center transition-colors",children:e.jsx(q,{size:20,className:"text-white"})})}),e.jsxs("div",{className:"flex-1 max-w-2xl w-full mx-auto px-6 pb-12",children:[e.jsx($,{color:y[d.category],children:d.category}),e.jsx("h1",{className:"text-2xl font-heading font-bold text-white mt-4 mb-4 leading-tight",children:d.title}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-white/40 mb-6",children:[e.jsx("span",{children:d.source}),e.jsx("span",{children:"|"}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(R,{size:12}),O(d.publishedAt)]})]}),e.jsx("p",{className:"text-base text-white/70 leading-relaxed whitespace-pre-line",children:d.summary}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-6",children:(G=d.tags)==null?void 0:G.map(s=>e.jsx("span",{className:"px-3 py-1 rounded-full text-xs",style:{background:`${y[d.category]||x.primary}15`,color:`${y[d.category]||x.primary}cc`},children:s},s))})]})]})})]})}export{je as default};

import{e as k,j as e,u as R,r as p,a as B,M as T,F as H,b as K,d as J,c as Y,B as Z,Z as Q,U as X,L as ee,S as E}from"./index-4wya-6k_.js";import{G as te}from"./GlassCard-CnwA8Pzd.js";import{P as ne}from"./PageHeader-B9TG-7vG.js";import{S as se,g as ie}from"./syncService-S-CTgAlo.js";import{B as ae}from"./bell-BiZ-BGN4.js";import{S as oe}from"./sun-BeFwQyDl.js";import{V as re}from"./volume-2-W38zmBTl.js";import{R as M}from"./refresh-cw-ZKgM05-y.js";import{T as le}from"./trash-2-CZmobZM4.js";const ce=k("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]),C=k("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),de=k("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),ue=k("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),D=k("WifiOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 4.17-2.65",key:"11utq1"}],["path",{d:"M10.66 5c4.01-.36 8.14.9 11.34 3.76",key:"hxefdu"}],["path",{d:"M16.85 11.25a10 10 0 0 1 2.22 1.68",key:"q734kn"}],["path",{d:"M5 13a10 10 0 0 1 5.24-2.76",key:"piq4yl"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]),me=k("Wifi",[["path",{d:"M5 13a10 10 0 0 1 14 0",key:"6v8j51"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]);function h({enabled:l,onChange:s}){return e.jsx("button",{onClick:()=>s==null?void 0:s(!l),className:`relative w-12 h-7 rounded-full transition-all duration-300 flex-shrink-0 ${l?"bg-gradient-to-r from-indigo-500 to-violet-500":"bg-white/10"}`,children:e.jsx("div",{className:`absolute top-0.5 w-6 h-6 rounded-full bg-white shadow-lg transition-transform duration-300 ${l?"translate-x-[22px]":"translate-x-0.5"}`})})}function pe(){const{state:l}=R(),s=p.useRef(null),n=p.useCallback(()=>((!s.current||s.current.state==="closed")&&(s.current=new(window.AudioContext||window.webkitAudioContext)),s.current.state==="suspended"&&s.current.resume(),s.current),[]),f=p.useCallback((u,o,g="sine",m=.15)=>{if(l.settings.soundEffects)try{const i=n(),r=i.createOscillator(),y=i.createGain();r.type=g,r.frequency.setValueAtTime(u,i.currentTime),y.gain.setValueAtTime(m,i.currentTime),y.gain.exponentialRampToValueAtTime(.001,i.currentTime+o),r.connect(y),y.connect(i.destination),r.start(i.currentTime),r.stop(i.currentTime+o)}catch{}},[l.settings.soundEffects,n]),N=p.useCallback(()=>{f(800,.08,"sine",.08)},[f]),c=p.useCallback(()=>{if(l.settings.soundEffects)try{const u=n(),o=u.currentTime;[523.25,659.25].forEach((g,m)=>{const i=u.createOscillator(),r=u.createGain();i.type="sine",i.frequency.setValueAtTime(g,o),r.gain.setValueAtTime(.12,o+m*.12),r.gain.exponentialRampToValueAtTime(.001,o+m*.12+.3),i.connect(r),r.connect(u.destination),i.start(o+m*.12),i.stop(o+m*.12+.3)})}catch{}},[l.settings.soundEffects,n]),v=p.useCallback(u=>{f(u?660:440,.1,"sine",.1)},[f]),S=p.useCallback(()=>{if(l.settings.soundEffects)try{const u=n(),o=u.currentTime;[587.33,698.46,880].forEach((g,m)=>{const i=u.createOscillator(),r=u.createGain();i.type="triangle",i.frequency.setValueAtTime(g,o),r.gain.setValueAtTime(.15,o+m*.15),r.gain.exponentialRampToValueAtTime(.001,o+m*.15+.4),i.connect(r),r.connect(u.destination),i.start(o+m*.15),i.stop(o+m*.15+.4)})}catch{}},[l.settings.soundEffects,n]);return{tap:N,success:c,toggle:v,timerDone:S}}function a({icon:l,label:s,description:n,children:f}){return e.jsxs("div",{className:"flex items-center justify-between py-3",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsx("div",{className:"w-9 h-9 rounded-xl bg-white/5 flex items-center justify-center flex-shrink-0",children:e.jsx(l,{size:18,className:"text-white/60"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-white",children:s}),n&&e.jsx("p",{className:"text-xs text-white/40 mt-0.5",children:n})]})]}),e.jsx("div",{className:"flex-shrink-0 ml-3",children:f})]})}function j({title:l,children:s}){return e.jsxs(te,{className:"mb-4",children:[e.jsx("h3",{className:"text-xs font-semibold text-white/40 uppercase tracking-wider mb-2",children:l}),e.jsx("div",{className:"divide-y divide-white/5",children:s})]})}function Se(){const{state:l,dispatch:s}=R(),{settings:n,auth:f}=l,N=B(),c=pe(),[v,S]=p.useState(!1),[u,o]=p.useState(navigator.onLine),[g,m]=p.useState(!1),[i,r]=p.useState(n.lastSyncTime||null),[y,P]=p.useState(typeof Notification<"u"?Notification.permission:"denied");p.useEffect(()=>{const t=()=>o(!0),d=()=>o(!1);return window.addEventListener("online",t),window.addEventListener("offline",d),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",d)}},[]);const A=async()=>{if(typeof Notification>"u")return;const t=await Notification.requestPermission();P(t)},b=(t,d)=>{s({type:"UPDATE_SETTINGS",payload:{[t]:d}})},L=t=>{b("darkMode",t),c.toggle(t),t?document.documentElement.removeAttribute("data-theme"):document.documentElement.setAttribute("data-theme","light")};p.useEffect(()=>{n.darkMode?document.documentElement.removeAttribute("data-theme"):document.documentElement.setAttribute("data-theme","light")},[n.darkMode]);const O=t=>{b("soundEffects",t),t&&setTimeout(()=>c.toggle(!0),50)},I=t=>{b("offlineMode",t),c.toggle(t),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(d=>{var x;(x=d.active)==null||x.postMessage({type:"SET_OFFLINE_MODE",payload:{enabled:t}})})},U=async t=>{if(t&&window.PublicKeyCredential)try{if(!await PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable()){alert("Biometric authentication is not available on this device.");return}}catch{}b("faceId",t),c.toggle(t),t||sessionStorage.removeItem("light_locked")},G=()=>{const t=E.exportAll(),d=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),x=URL.createObjectURL(d),w=document.createElement("a");w.href=x,w.download=`light-backup-${new Date().toISOString().split("T")[0]}.json`,w.click(),URL.revokeObjectURL(x),c.success()},$=()=>{const t=document.createElement("input");t.type="file",t.accept=".json",t.onchange=d=>{const x=d.target.files[0];if(!x)return;const w=new FileReader;w.onload=_=>{try{const z=JSON.parse(_.target.result);E.importAll(z),s({type:"HYDRATE"}),c.success()}catch{alert("Invalid backup file")}},w.readAsText(x)},t.click()},V=()=>{E.clearAll(),s({type:"HYDRATE"}),S(!1)},W=async()=>{m(!0);try{await se.fullSync();const t=Date.now();r(t),b("lastSyncTime",t),s({type:"HYDRATE"}),c.success()}catch(t){alert("Sync failed: "+t.message)}finally{m(!1)}},q=async()=>{const t=ie();t&&await t.auth.signOut().catch(()=>{}),s({type:"LOGOUT"}),N("/login")},F=()=>{if(!i)return"Never synced";const t=Date.now()-i,d=Math.floor(t/6e4);if(d<1)return"Just now";if(d<60)return`${d}m ago`;const x=Math.floor(d/60);return x<24?`${x}h ago`:`${Math.floor(x/24)}d ago`};return e.jsxs("div",{className:"space-y-2 pb-4",children:[e.jsx(ne,{title:"Settings",subtitle:"Customize your experience"}),!u&&e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 rounded-xl bg-amber-500/10 border border-amber-500/20 mb-2",children:[e.jsx(D,{size:16,className:"text-amber-400"}),e.jsx("span",{className:"text-sm text-amber-400",children:"You're offline â€” data is saved locally"})]}),e.jsxs(j,{title:"General",children:[e.jsx(a,{icon:ae,label:"Push Notifications",description:y==="granted"?"Sent via Service Worker":y==="denied"?"Blocked in browser settings":"Get reminders and alerts",children:e.jsxs("div",{className:"flex items-center gap-2",children:[y==="default"&&n.notifications&&e.jsx("button",{onClick:A,className:"text-xs text-indigo-400",children:"Allow"}),e.jsx(h,{enabled:n.notifications,onChange:t=>{b("notifications",t),c.toggle(t),t&&y==="default"&&A()}})]})}),e.jsx(a,{icon:n.darkMode?T:oe,label:"Dark Mode",description:n.darkMode?"Dark theme active":"Light theme active",children:e.jsx(h,{enabled:n.darkMode,onChange:L})}),e.jsx(a,{icon:re,label:"Sound Effects",description:"Tap, success, and timer sounds",children:e.jsx(h,{enabled:n.soundEffects,onChange:O})}),e.jsx(a,{icon:M,label:"Auto Sync",description:n.autoSync?"Syncs when data changes":"Login required for sync",children:e.jsx(h,{enabled:n.autoSync,onChange:t=>{b("autoSync",t),c.toggle(t)}})})]}),e.jsxs(j,{title:"Privacy & Security",children:[e.jsx(a,{icon:H,label:"Face ID / Fingerprint",description:"Lock app when switching away",children:e.jsx(h,{enabled:n.faceId,onChange:U})}),e.jsx(a,{icon:n.offlineMode?D:me,label:"Offline Mode",description:n.offlineMode?"Cache-first, works offline":"Network-first, always fresh",children:e.jsx(h,{enabled:n.offlineMode,onChange:I})})]}),e.jsxs(j,{title:"Reminders",children:[e.jsx(a,{icon:T,label:"Sleep Wind-Down",description:`Daily at ${n.reminders.sleepWindDown.time||"10:30 PM"}`,children:e.jsx(h,{enabled:n.reminders.sleepWindDown.enabled,onChange:t=>{s({type:"UPDATE_REMINDER",payload:{sleepWindDown:{...n.reminders.sleepWindDown,enabled:t}}}),c.toggle(t)}})}),e.jsx(a,{icon:K,label:"Workout",description:`Mon/Wed/Fri at ${n.reminders.workout.time||"7:00 AM"}`,children:e.jsx(h,{enabled:n.reminders.workout.enabled,onChange:t=>{s({type:"UPDATE_REMINDER",payload:{workout:{...n.reminders.workout,enabled:t}}}),c.toggle(t)}})}),e.jsx(a,{icon:J,label:"Vocal Practice",description:`Daily at ${n.reminders.vocalPractice.time||"6:00 PM"}`,children:e.jsx(h,{enabled:n.reminders.vocalPractice.enabled,onChange:t=>{s({type:"UPDATE_REMINDER",payload:{vocalPractice:{...n.reminders.vocalPractice,enabled:t}}}),c.toggle(t)}})}),e.jsx(a,{icon:Y,label:"Budget Alerts",description:"Spending notifications",children:e.jsx(h,{enabled:n.reminders.budgetAlerts.enabled,onChange:t=>{s({type:"UPDATE_REMINDER",payload:{budgetAlerts:{...n.reminders.budgetAlerts,enabled:t}}}),c.toggle(t)}})}),e.jsx(a,{icon:Z,label:"Reading Goal",description:`Daily at ${n.reminders.readingGoal.time||"9:00 PM"}`,children:e.jsx(h,{enabled:n.reminders.readingGoal.enabled,onChange:t=>{s({type:"UPDATE_REMINDER",payload:{readingGoal:{...n.reminders.readingGoal,enabled:t}}}),c.toggle(t)}})})]}),e.jsx(j,{title:"AI Integration",children:e.jsx(a,{icon:Q,label:"Anthropic API Key",description:n.anthropicApiKey?"Key is set":"Required for AI news",children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("input",{type:"password",value:n.anthropicApiKey||"",onChange:t=>b("anthropicApiKey",t.target.value),placeholder:"sk-ant-...",className:"w-36 px-2 py-1.5 rounded-lg text-xs bg-white/5 border border-white/10 outline-none focus:border-indigo-500/50",style:{color:"var(--text-primary)"}})})})}),e.jsxs("button",{className:"w-full py-4 rounded-glass font-heading font-semibold text-white flex items-center justify-center gap-2 mb-4",style:{background:"linear-gradient(135deg, #6366f1, #8b5cf6)",boxShadow:"0 4px 20px rgba(99,102,241,0.3)"},onClick:()=>{window.deferredPrompt&&window.deferredPrompt.prompt()},children:[e.jsx(C,{size:20}),"Install App"]}),e.jsxs(j,{title:"Data Management",children:[e.jsx(a,{icon:C,label:"Export Data",description:"Download JSON backup",children:e.jsx("button",{onClick:G,className:"btn-ghost text-xs",children:"Export"})}),e.jsx(a,{icon:ue,label:"Import Data",description:"Restore from backup",children:e.jsx("button",{onClick:$,className:"btn-ghost text-xs",children:"Import"})}),e.jsx(a,{icon:le,label:"Clear All Data",description:"Delete everything",children:v?e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:V,className:"px-3 py-1.5 rounded-xl text-xs font-medium text-white bg-red-500 hover:bg-red-600 transition-colors",children:"Confirm"}),e.jsx("button",{onClick:()=>S(!1),className:"px-3 py-1.5 rounded-xl text-xs font-medium text-white/50 bg-white/5",children:"Cancel"})]}):e.jsx("button",{onClick:()=>S(!0),className:"px-3 py-1.5 rounded-xl text-xs font-medium text-red-400 bg-red-500/10 hover:bg-red-500/20 transition-colors",children:"Clear"})})]}),e.jsxs(j,{title:"Account & Sync",children:[e.jsx(a,{icon:X,label:"Logged in as",description:f.username?`${f.username}${f.email?` (${f.email})`:""}`:"Guest",children:f.userId&&e.jsx("span",{className:"text-[10px] text-green-400 bg-green-500/10 px-2 py-0.5 rounded-full",children:"Connected"})}),f.userId&&e.jsx(a,{icon:ce,label:"Manual Sync",description:`Last sync: ${F()}`,children:e.jsxs("button",{onClick:W,disabled:g,className:"flex items-center gap-1.5 px-3 py-1.5 rounded-xl text-xs font-medium text-indigo-400 bg-indigo-500/10 hover:bg-indigo-500/20 transition-colors disabled:opacity-50",children:[g?e.jsx(ee,{size:12,className:"animate-spin"}):e.jsx(M,{size:12}),g?"Syncing...":"Sync Now"]})}),e.jsx(a,{icon:de,label:"Log Out",description:"Sign out of your account",children:e.jsx("button",{onClick:q,className:"px-3 py-1.5 rounded-xl text-xs font-medium text-red-400 bg-red-500/10 hover:bg-red-500/20 transition-colors",children:"Log Out"})})]}),e.jsxs("div",{className:"text-center py-6",children:[e.jsx("p",{className:"text-xs text-white/30",children:"Light v3.0.0"}),e.jsx("p",{className:"text-xs text-white/20 mt-1",children:"Made with care for Stefan"})]})]})}export{Se as default};
